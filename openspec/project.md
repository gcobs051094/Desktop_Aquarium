# Project Context

## Purpose
Desktop Feeding Fish 是一個桌面養魚遊戲應用程式，使用透明視窗技術讓使用者可以在桌面上飼養和照顧虛擬魚類。專案目標是創建一個類似桌面小助手的互動式桌面寵物體驗，使用者可以隨時與桌面上的魚類進行交互，類似於經典的 Insaniquarium 遊戲概念。應用程式以透明視窗的形式存在於桌面上，不干擾使用者的日常工作，同時提供隨時可用的互動功能。

## Tech Stack
- **Python 3.12** - 主要開發語言（使用 Anaconda 環境 MCP_py312）
- **PyQt6** - GUI 框架，用於創建透明視窗和桌面應用程式界面
- **圖形處理** - PIL/Pillow 用於圖像處理和資源管理

## Project Conventions

### Code Style
- 遵循 PEP 8 Python 編碼規範
- 使用有意義的變數和函數名稱
- 添加適當的註釋和文檔字符串
- 優先使用類型提示（Type Hints）以提高代碼可讀性

### Architecture Patterns
- 採用模組化設計，將不同功能分離到獨立模組
- 使用物件導向設計模式處理遊戲實體（魚類、食物等）
- 分離業務邏輯和 UI 層
- **透明視窗管理**：獨立的視窗管理模組處理透明視窗的創建、事件處理和渲染
- **事件處理**：實現滑鼠事件處理和點擊區域管理，確保透明區域的正確行為
- **渲染層**：考慮使用 QPainter 或 QGraphicsScene 進行高效的自訂繪圖

### Testing Strategy
- 為核心遊戲邏輯編寫單元測試
- 使用 pytest 作為測試框架
- 確保關鍵功能有測試覆蓋

### Git Workflow
- 使用語義化的提交訊息
- 主要分支：main（或 master）
- 功能開發使用 feature 分支
- 提交前確保代碼通過 linting 和測試

## Domain Context

### 遊戲實體
- **魚類**：多種不同類型的魚類（如小孔雀魚等），每種魚類可能有不同的外觀、行為和屬性
- **食物**：多種不同類型的食物，用於餵養魚類
- **怪物**：不定時出現的敵對實體，會攻擊並吃掉魚類
- **場景**：多種不同的遊戲場景/環境，提供不同的視覺體驗

### 核心遊戲機制

#### 餵食系統
- 使用者可以投放食物來餵養魚類
- 不同類型的食物可能有不同的效果（例如：增加生命值、成長速度等）
- 食物需要正確地投放到魚類附近或特定區域

#### 魚類生命週期
- 魚類具有完整的生命週期管理（出生、成長、死亡）
- 需要適當的照顧（餵食）來維持魚類的生命
- 魚類可能會有不同的狀態（飢餓、健康、成長等）

#### 怪物機制
- **不定時出現**：怪物會隨機或按特定規則不定時地出現在遊戲場景中
- **攻擊行為**：怪物會主動攻擊並吃掉魚類，對魚類造成威脅
- **點擊擊敗**：使用者需要通過點擊怪物來擊敗它們，保護魚類
- 擊敗怪物可能需要多次點擊或特定操作

#### 互動機制
- 使用者可以與遊戲中的各種實體進行互動（點擊、拖拽等）
- 透明視窗設計允許使用者在桌面環境中隨時進行互動
- 需要處理滑鼠事件來實現點擊擊敗怪物、投放食物等操作

### 資源管理
- 圖像資源存放在 `resource/` 目錄下
- 需要管理多種魚類、食物、怪物和場景的圖像資源
- 考慮資源的載入、快取和釋放策略，以確保良好的性能

## Important Constraints
- **透明視窗**：應用程式使用透明視窗技術，需要確保視窗透明度和點擊穿透的正確處理
- **桌面整合**：作為桌面小助手，應用程式應該能夠與桌面環境良好整合，不干擾使用者操作
- **跨平台兼容性**：優先支援 Windows，但需考慮 PyQt6 的跨平台特性
- **資源管理**：
  - 圖像資源需要適當管理（多種魚類、食物、怪物、場景的圖像）
  - 考慮透明 PNG 格式的使用
  - 實現資源的動態載入和快取機制，避免記憶體過度使用
- **性能考量**：
  - 確保遊戲運行流暢，不影響系統性能，特別是透明視窗的渲染性能
  - 多個遊戲實體（魚類、食物、怪物）同時存在時的渲染優化
  - 怪物不定時出現的機制需要高效的隨機事件處理
- **互動設計**：
  - 透明視窗需要考慮滑鼠事件處理和點擊區域的設計
  - 點擊擊敗怪物的機制需要精確的碰撞檢測和事件響應
  - 餵食系統需要直觀的互動方式（例如：點擊投放食物）
- **遊戲平衡**：
  - 怪物出現頻率和強度需要平衡，避免過於困難或簡單
  - 魚類生命週期和餵食需求需要合理的數值設計

## External Dependencies
- **Python 3.12**（Anaconda 環境 MCP_py312）
- **PyQt6** - GUI 框架和透明視窗支援
- **Pillow (PIL)** - 圖像處理和資源載入
