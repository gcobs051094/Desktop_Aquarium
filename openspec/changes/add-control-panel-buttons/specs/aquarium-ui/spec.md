## ADDED Requirements

### Requirement: 水族箱控制面板
水族箱視窗 SHALL 在水族箱區域外的透明視窗區域內提供一個控制面板，包含三個功能按鈕：切換背景、切換飼料、投放魚。控制面板 SHALL 位於水族箱右側，寬度為 180px，具有不透明背景以便使用者辨識。

#### Scenario: 控制面板顯示
- **WHEN** 水族箱視窗啟動
- **THEN** 視窗右側顯示一個 180px 寬的控制面板
- **AND** 控制面板具有深色半透明背景（rgba(40, 44, 52, 230)）和圓角樣式
- **AND** 控制面板區域可接收滑鼠事件（非透明穿透）

#### Scenario: 視窗尺寸調整
- **WHEN** 控制面板功能啟用
- **THEN** 視窗總寬度 SHALL 為水族箱寬度 + 180px（面板寬度）
- **AND** 視窗高度保持不變（僅水族箱高度）
- **AND** 視窗遮罩包含水族箱區域與控制面板區域

### Requirement: 切換背景功能
系統 SHALL 提供「切換背景」按鈕，點擊後展開清單顯示所有可用的背景圖片，使用者選擇後立即切換水族箱背景。

#### Scenario: 背景清單展開
- **WHEN** 使用者點擊「切換背景」按鈕
- **THEN** 按鈕下方展開一個清單選單
- **AND** 清單顯示 `resource/background/` 目錄中的所有 .jpg 和 .png 檔案
- **AND** 清單項目顯示檔案名稱（不含副檔名）

#### Scenario: 背景切換
- **WHEN** 使用者從清單中選擇一個背景圖片
- **THEN** 水族箱背景立即切換為選中的圖片
- **AND** 背景圖片自動縮放以適應水族箱尺寸（保持長寬比，可能裁切）

### Requirement: 切換飼料功能
系統 SHALL 提供「切換飼料」按鈕，點擊後展開清單顯示所有可用的飼料類型，使用者選擇後儲存為當前飼料類型。

#### Scenario: 飼料清單展開
- **WHEN** 使用者點擊「切換飼料」按鈕
- **THEN** 按鈕下方展開一個清單選單
- **AND** 清單顯示 `resource/feed/` 目錄中的所有子目錄（飼料類型）
- **AND** 清單項目顯示子目錄名稱（例如：「便宜飼料」、「藥丸」、「鯉魚飼料」）

#### Scenario: 飼料選擇儲存
- **WHEN** 使用者從清單中選擇一個飼料類型
- **THEN** 系統儲存選中的飼料類型名稱與路徑
- **AND** 儲存的飼料類型可供未來投放飼料功能使用

### Requirement: 投放魚功能
系統 SHALL 提供「投放魚」按鈕，點擊後展開清單顯示所有可用的魚種，使用者選擇後在水族箱內新增一條該類型的魚。

#### Scenario: 魚種清單展開
- **WHEN** 使用者點擊「投放魚」按鈕
- **THEN** 按鈕下方展開一個清單選單
- **AND** 清單顯示 `resource/fish/` 目錄中所有名稱包含 "small" 的子目錄層級
- **AND** 清單項目顯示格式為「魚種名稱 / small 變體名稱」（例如：「guppy / small_guppy」）

#### Scenario: 新增魚類到水族箱
- **WHEN** 使用者從清單中選擇一個魚種
- **THEN** 系統載入該魚種的游泳與轉向動畫（使用 "5_吃飽游泳" 和 "7_吃飽轉向" 行為）
- **AND** 在水族箱內隨機位置新增一條該類型的魚
- **AND** 魚的初始方向為隨機角度（0-360度）
- **AND** 魚的游動速度為隨機值（0.4-0.8 像素/幀）
- **AND** 魚的顯示縮放為 1.25 倍

### Requirement: 空水族箱初始狀態
水族箱 SHALL 在啟動時為空狀態，不預載任何魚類，使用者必須透過「投放魚」按鈕自行新增魚類。

#### Scenario: 初始空水族箱
- **WHEN** 水族箱視窗啟動
- **THEN** 水族箱內不包含任何魚類
- **AND** 使用者必須透過「投放魚」按鈕才能新增魚類到水族箱

## MODIFIED Requirements

### Requirement: 水族箱視窗尺寸與遮罩
水族箱視窗 SHALL 支援在水族箱區域外新增控制面板區域，視窗總寬度為水族箱寬度加上面板寬度（180px）。視窗遮罩 SHALL 包含水族箱區域與控制面板區域，使這兩個區域可接收滑鼠事件，其餘透明區域實現點擊穿透。

#### Scenario: 視窗尺寸調整
- **WHEN** 控制面板功能啟用
- **THEN** 視窗總寬度 SHALL 為水族箱寬度 + 180px
- **AND** 視窗高度保持為水族箱高度

#### Scenario: 遮罩更新
- **WHEN** 視窗大小改變
- **THEN** 視窗遮罩 SHALL 包含水族箱矩形與控制面板矩形
- **AND** 水族箱區域與控制面板區域可接收滑鼠事件
- **AND** 其餘透明區域實現點擊穿透

### Requirement: 背景圖片動態切換
水族箱 SHALL 支援在運行時動態切換背景圖片，無需重新啟動視窗。

#### Scenario: 背景動態載入
- **WHEN** 使用者透過「切換背景」功能選擇新的背景圖片
- **THEN** 水族箱立即載入新的背景圖片
- **AND** 背景圖片自動縮放以適應水族箱尺寸
- **AND** 水族箱立即重繪以顯示新背景
